---
title: get_attachment_string
---

Эта функция предназначена для обработки информации связанной с вложениями объекта
##### Параметры функции:

- `attachments`: объект класса `DiffAttachments`, переданный для обработки,
- `lang`: объект типа `string` - строка, содержащая "ключ" языка для выбора соответствующего шаблона при подготовке строки.
##### Результат работы функции:

- объект типа `string`, содержащий извлеченную информацию.
##### Алгоритм работы функции:

В зависимости от действий с вложениями возможны следующие значения атрибутов переданного объекта `attachments`:

| Действие            | Значение атрибутов в необработанном WebHook:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| добавление вложений | "*data*": {<br>  ...<br>  "*change*": {<br>    ...<br>	"diff": {<br>      "*attachments*": {<br>        "*new*": [<br>          {<br>            "*id*": 1,<br>            "*filename*": "filename.ext",<br>            "*url*": "http://permalink_to_file",<br>            "*attached_file*": "path_to_file/filename.ext",<br>            "thumbnail_file": null,<br>            "is_deprecated": false,<br>            "description": "",<br>            "order": 0<br>          },<br>		  {<br>            "*id*": 2,<br>            "*filename*": "filename.ext",<br>            "*url*": "http://permalink_to_file",<br>            "*attached_file*": "path_to_file/filename.ext",<br>            "thumbnail_file": null,<br>            "is_deprecated": false,<br>            "description": "",<br>            "order": 0<br>          },<br>        ],<br>        "changed": [],<br>        "deleted": []<br>      }<br>    }<br>  }<br>} |
| изменение вложений  | "*data*": {<br>  ...<br>  "*change*": {<br>    ...<br>	"*diff*": {<br>      "*attachments*": {<br>        "*new*": [],<br>        "*changes*": {<br>          "*description*": [<br>            "",<br>            "test"<br>          ],<br>          "*is_deprecated*": [<br>            false,<br>            true<br>          ]<br>        }<br>      "*deleted*": []<br>    }<br>  }<br>}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| удаление вложений   | "*data*": {<br>  ...<br>  "*diff*": {<br>    "*attachments*": {<br>    "*new*": \[],<br>    "*changed*": \[],<br>    "*deleted*": \[<br>	  {<br>	    "*id*": 1,<br>	    "*url*": "http://permalink_to_file"<br>	    "*filename*": "filename.ext",<br>	    "*description*": "",<br>	    "*attached_file*": "path_to_file/filename.ext",<br>	    "*is_deprecated*": false,<br>	    "*thumbnail_file*": null<br>	    }<br>      ]<br>    }<br>  }<br>}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
В зависимости от значения атрибута `new`, `changed`, `deleted` определяется вид действия с вложениями.
Вложения могут быть добавлены группой (сразу несколько файлов). Удаление и изменение вложений возможно только по одному вложению за операцию.
В существующем вложении могут быть изменены: описание (атрибут - `description`) и метка "устаревший" (`is_deprecated`). При этом в сформированном `WebHook` отсутствует информация о том, какой именно объект изменен. Поэтому функцией формируется абстрактное текстовое сообщение, не содержащее подробностей о измененном файле.
##### Пример вызова функции:

```python
attachment_string = get_attachment_string(
	attachments=payload.change.diff.attachments, lang="en")
```
