---
title: get_change_points_string
---

Эта функция предназначена для обработки информации связанной с изменениями в комментариях объекта
##### Параметры функции:

- `change`: объект класса `Change`, переданный для обработки,
- `lang`: объект типа `string` - строка, содержащая "ключ" языка для выбора соответствующего шаблона при подготовке строки.
##### Результат работы функции:

- объект типа `string`, содержащий извлеченную информацию.
##### Алгоритм работы функции:

В зависимости от действий с комментариями возможны следующие значения атрибутов переданного объекта `change`:

| Действие               | Значение атрибутов в необработанном WebHook:                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ---------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| добавление комментария | "*data*": {<br>  ...<br>  "*change*": {<br>    "*comment*": "Test",<br>    "*comment_html*": "\<p>Test\</p>",<br>    "*delete_comment_date*": null,<br>    "*comment_versions*": null,<br>    "*edit_comment_date*": null,<br>    "*diff*": {}<br>  }<br>}                                                                                                                                                                                                                                                |
| изменение комментария  | "*data*": {<br>  ...<br>  "*change*": {<br>    "*comment*": "Test new",<br>    "*comment_html*": "\<p>Test new\</p>",<br>    "*delete_comment_date*": null,<br>    "*comment_versions*": \[<br>      {<br>        "*date*": "2025-02-23T08:50:36.070Z",<br>        "*comment*": "Test",<br>        "*comment_html*": "\<p>Test\</p>",<br>		"*user*": {<br>          "*id*": 5<br>        }<br>      }<br>    ],<br>    "*edit_comment_date*": "2025-02-23T08:51:26.207Z",<br>    "*diff*": {}<br>  }<br>} |
| удаление комментария   | "*data*": {<br>  ...<br>  "*change*": {<br>    "*comment*": "Test new",<br>    "*comment_html*": "\<p>Test new\</p>",<br>    "*delete_comment_date*": "2025-02-23T08:52:13.548Z",<br>    "*comment_versions*": null,<br>    "*edit_comment_date*": null,<br>    "*diff*": {}<br>  }<br>}                                                                                                                                                                                                                  |
Вид действия с комментарием определяется по факту наличия информации в атрибутах `delete_comment_date`, `edit_comment_date` (значение не равно *null*).

Для формирования значения `comment_text` в формируемом значении используется значение атрибута `comment_html`, обработанное функцией [[06_get_untag_truncated_string|get_untag_truncated_string]]
##### Пример вызова функции:

```python
comment_string = get_comment_string(change=payload.change, lang="en")
```
